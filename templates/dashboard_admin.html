<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Panel Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 text-gray-900 dark:bg-gray-900 dark:text-gray-100">
  <div class="max-w-7xl mx-auto p-6">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold">ğŸ“Š Panel Administrador</h2>
      <div class="flex gap-2">
        <button onclick="document.documentElement.classList.toggle('dark')"
          class="px-3 py-2 rounded bg-gray-300 dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm">
          ğŸŒ“ Cambiar tema
        </button>
        <a href="{{ url_for('mapa_admin') }}"
          class="px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm">Ver mapa global</a>
        <a href="{{ url_for('logout') }}"
          class="px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm">Cerrar sesiÃ³n</a>
      </div>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-4 max-w-3xl mx-auto">
          {% for category, msg in messages %}
            <div class="px-3 py-2 rounded mb-2 {{ 'bg-red-100 text-red-800' if category=='error' else 'bg-green-100 text-green-800' }}">{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}


    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow">
        <p class="text-sm text-gray-500 dark:text-gray-400">Camiones</p>
        <p class="text-2xl font-bold">{{ total_trucks }}</p>
      </div>
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow">
        <p class="text-sm text-gray-500 dark:text-gray-400">Choferes</p>
        <p class="text-2xl font-bold">{{ total_drivers }}</p>
      </div>
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow">
        <p class="text-sm text-gray-500 dark:text-gray-400">Despachadores</p>
        <p class="text-2xl font-bold">{{ total_dispatchers }}</p>
      </div>
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow">
        <p class="text-sm text-gray-500 dark:text-gray-400">Rutas</p>
        <p class="text-2xl font-bold">{{ total_routes }}</p>
      </div>
    </div>


    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold dark:text-white">Camiones recientes</h3>
          <a href="{{ url_for('admin_trucks') }}" class="text-sm text-blue-600 dark:text-blue-400">Ver todos</a>
        </div>
        {% if recent_trucks %}
        <ul class="text-sm dark:text-white">
          {% for t in recent_trucks %}
          <li class="py-1 border-t dark:border-gray-700">{{ t.plate }} â€” {{ t.cargo or 'Sin carga' }} â€” {{ t.status }}
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-sm text-gray-500">No hay camiones.</p>
        {% endif %}
      </div>

      <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold dark:text-white">Rutas recientes</h3>
          <a href="{{ url_for('admin_routes') }}" class="text-sm text-blue-600 dark:text-blue-400">Ver todas</a>
        </div>
        {% if recent_routes %}
        <ul class="text-sm dark:text-white">
          {% for r in recent_routes %}
          <li class="py-1 border-t dark:border-gray-700">{{ r.origin }} â†’ {{ r.destination }} â€” {{ r.status }} {% if
            r.truck %} ({{
            r.truck.plate }}){% endif %}</li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-sm text-gray-500">No hay rutas.</p>
        {% endif %}
      </div>
    </div>

    <div class="bg-white dark:bg-slate-800 p-4 rounded-lg shadow mb-6">
      <h3 class="font-semibold mb-2 dark:text-white">Actividad reciente</h3>
      {% if recent_activity %}
      <ul class="text-sm dark:text-white">
        {% for act in recent_activity %}
        <li class="py-1 border-t dark:border-gray-700">
          {% if act.type == "camiÃ³n" %}
          ğŸšš {{ act.desc }}
          {% elif act.type == "ruta" %}
          ğŸ›£ï¸ {{ act.desc }}
          {% endif %}
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-gray-500 text-sm">No hay actividad reciente.</p>
      {% endif %}
    </div>
  </div>
  <script>
    tailwind.config = {
      darkMode: 'class'
    }
  </script>

</body>

</html>